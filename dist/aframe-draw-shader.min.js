!function(t){function e(s){if(i[s])return i[s].exports;var a=i[s]={exports:{},id:s,loaded:!1};return t[s].call(a.exports,a,a.exports,e),a.loaded=!0,a.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e){"use strict";if("undefined"==typeof AFRAME)throw"Component attempted to register before AFRAME was available.";var i=AFRAME.utils.debug;i.enable("shader:draw:warn");var s=(i("shader:draw:warn"),i("shader:draw:debug"));AFRAME.registerShader("draw",{schema:{color:{type:"color"},fog:{"default":!0},src:{"default":null},fps:{type:"number","default":60},width:{"default":256},height:{"default":256}},init:function(t){return s("init",t),this.__cnv=document.createElement("canvas"),this.__cnv.width=this.schema.width["default"],this.__cnv.height=this.schema.height["default"],this.__ctx=this.__cnv.getContext("2d"),this.__texture=new THREE.Texture(this.__cnv),this.__reset(),this.material=new THREE.MeshBasicMaterial({map:this.__texture}),this.el.sceneEl.addBehavior(this),this.material},update:function(t){return s("update",t),this.__updateMaterial(t),this.__updateTexture(t),this.material},tick:function(t){if(!(this.__fps<=0)&&this.__nextTime){var e=Date.now();e>this.__nextTime&&this.__render()}},__updateMaterial:function(t){var e=this.material,i=this.__getMaterialData(t);Object.keys(i).forEach(function(t){e[t]=i[t]})},__getMaterialData:function(t){return{fog:t.fog,color:new THREE.Color(t.color)}},__updateTexture:function(t){this.__cnv.width=t.width?THREE.Math.nearestPowerOfTwo(t.width):this.schema.width["default"],this.__cnv.height=t.height?THREE.Math.nearestPowerOfTwo(t.height):this.schema.height["default"],"undefined"==typeof t.fps?this.__fps=this.schema.fps["default"]:t.fps&&t.fps>0?this.__fps=t.fps:this.__fps=0,this.__fps>0?this.__render():this.__nextTime=null},pause:function(){s("pause"),this.__nextTime=null},play:function(){s("play"),this.__nextTime||this.__render()},togglePlayback:function(){this.paused()?this.play():this.pause()},paused:function(){return!(this.__fps>0)},__clearCanvas:function(){this.__ctx&&this.__texture&&(this.__ctx.clearRect(0,0,this.__width,this.__height),this.__texture.needsUpdate=!0)},__render:function(){var t=this;s("render"),this.__nextTime=null,this.el.emit("draw-render",{ctx:this.__ctx,texture:this.__texture}),requestAnimationFrame(function(){t.__texture&&(t.__texture.needsUpdate=!0,t.__setNextTick())})},__setNextTick:function(){this.__fps>0&&(this.__nextTime=Date.now()+1e3/this.__fps)},__reset:function(){this.pause(),this.__clearCanvas()}})}]);